<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Ursula and Veronica -- The Fate of the Jews in Europe, Visualized </title>
    <script src="https://d3js.org/d3.v5.min.js"></script>
    <script src="functions.js" ></script>
    <script src="graph-scroll.js"></script>
    <script src="https://unpkg.com/topojson@3"></script>
    <script src="http://d3js.org/colorbrewer.v1.min.js"></script>

    <style>

    body {
        max-width: 900px;
        margin: auto;

        font-family: "Trebuchet MS", Helvetica, sans-serif;
        line-height: 1.5;
    }

    h1{
        background-color: cadetblue;
        margin: 50px;
        color: white;
    }

    h1{
        text-align: center;
    }

    .hidden{
        display:none;
    }

    #container{
        position: relative;
    }

    #sections{
        width: 375px;
        padding-bottom:300px;
    }

    #sections > section{
        opacity: .2;
        margin-bottom: 200px;
        padding-left: 15px;
        border-left: 5px solid darkgrey ;
    }

    #sections > section.graph-scroll-active{
        opacity: 1;
        border-left: 6px solid darkgrey ;
    }

    #graph{
        margin-left: 30px;
        width: 500px;
        position: sticky;
        top: 20px;
        float: right;
    }

    #key{

        margin-left: 20px;
        width: 500px;
        position: sticky;
        top: 600px;
        float: right;
    }

    #graph svg{
        border:solid 5px lightgrey;
    }
    #key svg{
        border:solid 5px lightgrey;
    }

  </style>

</head>
<body>
    <h1>The Fate of European Jews in the Holocaust</h1>
    <div id="container">
            <div id="graph"></div>
            <div id="key"></div>
    <div id="sections">

        <section>
            <h3>Introduction: Pre-Holocaust Jewish Population by Country</h3>
            In 1938 approximately 9.5 million Jews lived in Europe, comprising 1.7% of the total European population. This number represented more than 60% of the world's Jewish population at that time which was estimated at 15.3 million. Over half of the Jewish population lived in Poland, Romania, and the USSR. The Soviet Union alone was home to 3.4 million Jews, the most of any country in Europe.
        </section>
        <section>
          <h3>Map of Locations of Camps</h3>
            From 1938 to 1944 an estimated 6 million Jews died in the Holocaust. The most common and well-known way places people died in the Holocaust was at Concentration and Extermination Camps. There were over 50 Concentration Camps scattered across Europe that were used to imprision enemies of the state such as P.O.W's, communists, homosexuals, and criminals. There were only 6 Extermination Camps which were all located in Poland. These camps are unique from the others because very few people were sent to live there, most were killed upon arrival. They were designed by the Nazis with the express intention of exterminating the Jews of Europe.
            <br>
            Use the menu below to show each type of camp on the map.
            <br>
            <form id="controls">
              <input id="cc-camps" type="checkbox" name="layer" value="point-layer">Concentration Camps
              <br>
              <input type="checkbox" name="layer" value="contour-layer">Extermination Camps

            </form>

        </section>

        <section>
            <h3>9.5 Million Jews Revisualized</h3>
            It's difficult to get a sense of scale for 9.5 million people. Even more difficult is to trace the path of the Jewish Population through the Holocaust in relation to the total number of deaths. Due to poor record keeping it is impossible to determine exactly how many people died where, but there are approximations that help us understand how Jews died in the Holocaust. This is a graph of the pre-Holocaust population of Jews in Europe with every ten thousand people represented by a circle.
            Continue to explore the demographics, locations, and method of death.
        </section>
        <section>
            <h3>Deaths by Demographic</h3>
            The Nazis began by selecting the most vulerable populations for extermination: children, women, and the elderly. Of all the Jews who survived the Holocaust most were able-bodied men over the age of 18, due to their capability to work as forced laborers in camps. There were womens camps at Ravensbr√ºck, Bergen-Belsen, and Auchwitz-Birkenau, but these represent only a small fraction of the women who lived during the Holocaust. Children fared the worst, the few who survived were either hidden or lived under forged identities.
            <br>
            Use the menu below to select a demographic to view.
            <br><br>
            <select id="color_option">
                <option value="children">Children</option>
                <option value="women">Women</option>
                <option value="elderly">Elderly</option>
            </select>
            <br><br>
            All combined, women, children, and the elderly make up just more than half of the victims.

        </section>
        <section>
          <h3>Deaths by Location -- Concentration Camps, Shooting, and Others</h3>
          <p>
          Though it is commonly believed that most Jews died in Extermination Camps, almost half of all deaths came through uncoordated measures. Early on in the Holocaust many Jews were sent to makeshift camps in Poland and Russia without food or supplies and died of exposure. Many were also sent to concentration camps where they perished due to disease or malnutrition. Over a million russian Jews died when Hitler invaded Russia in 1941. Following behind the troops were four special task forces called the Einzatsgruppen, who would move in after a town had been conqured and shoot all the Jews who lived there.
          <br>
          <form id="other_option">
            <input type="checkbox" name="camps" value="western"> Killed in Western Poland
            <br>
            <input type="checkbox" name="camps" value="concentration"> Concentration Camps
            <br>
            <input type="checkbox" name="camps" value="russian"> Russian Jews Shot in the Soviet Union
            <br>
            <input type="checkbox" name="camps" value="german"> German, Austrian, and Czech Jews killed in the Soviet Union
            <br>
            <input type="checkbox" name="camps" value="other"> Other
            <br>
            <input type="checkbox" name="camps" value="reset"> Reset
          </form>
        </section>
        <section>
          <h3>Deaths by Location -- Extermination Camps and Ghettos</h3>
          <p>The other half of the deaths in the Holocaust happened in Extermination Camps and Ghettos. In 1938 when the Nazis invaded Poland, Hitler decided to forcibly centralize the Jewish population in Ghettos across major Europen cities. Conditions in the Ghettos were so bad that in the Warsaw Ghetto alone 300,000 people died. From Ghettos, the Jews were shipped to extermination camps where all but a select few were murdered. These camps were so efficient that, for example,  on a good day in Belzec everyone transported there died within an hour.
          <br>
          <form id="camp_option">
            <input type="checkbox" name="camps" value="Auschwitz"> Auschwitz Complex
            <br>
            <input type="checkbox" name="camps" value="Treblinka"> Trebkinka 2
            <br>
            <input type="checkbox" name="camps" value="Belzec"> Belzec
            <br>
            <input type="checkbox" name="camps" value="Sobibor"> Sobibor
            <br>
            <input type="checkbox" name="camps" value="Chelmno"> Chelmno
            <br>
            <input type="checkbox" name="camps" value="Ghettos"> Ghettos
            <br>
            <input type="checkbox" name="camps" value="reset"> Reset
          </form>

        </section>
        <section>
          <h3>Conclusion</h3>

            In total only three million Jews survived. Among the countries hardest hit was Poland, who lost 90% of their Jewish Population, and Greece who lost 82%. On average two-thirds of the Jewish Population in every country died. Generally the further east a country was, the more of the Jewish population it lost due to it's proximity to the extermination camps.
            <br> - - - - - - - - - <br>
            This visualization was created with data from the US Holocaust Museum Encyclopedia and from HIST 0275.
            <a href="https://encyclopedia.ushmm.org/content/en/article/documenting-numbers-of-victims-of-the-holocaust-and-nazi-persecution">Link to Statistics</a>
            <br><br>
            Thank you to Professor Rebecca Bennette, head of Jewish Studies at Middlebury College.
            <br><br>
            By: Ursula Alwang and Veronica Estudillo Velasco
            Created for: CS 0465 at Middlebury College

        </section>
    </div>

</div>

<script>

const width = 575, height = 727
Promise.all([
    d3.json("europe-topo.json"),
    d3.csv("camps.csv"),
    d3.csv("extermination.csv"),
    d3.csv("overview_data.csv")
]).then(function(data){
    const map_data = data[0];
    const camps_data = data[1];
    const extermination_data = data[2];
    const overview_data = data[3];

    const color_scale = d3.scaleOrdinal(d3.schemeCategory10);
    const svg = d3.select("#graph").append("svg")
        .attr("width", 600)
        .attr("height", 400);

    const key = d3.select("#key").append("svg")
        .attr("width", 600)
        .attr("height", 60);

        //create the data that represents all the 9.6 million jews in Europe before the holocaust. 1 circle will represent 10,000 people. The  dots are objects with indexes that we will then use to assign them a class. The classes correspond to the place of death, type, or demographic characteristic
        var dots = [];

        for (let i = 0; i < 960; i++) {
          dots.push({"key": i, "value": null})
          //console.log(dots[i].key)
        }



    const bar_chart_1 = create_first_barchart(svg, 550, 330, "prewar", overview_data);
    const bar_chart_2 = create_first_barchart(svg, 550, 330, "percentage", overview_data);
    const dot_plot = create_iris_plot(svg, 550, 330, dots);
    const map_plot = europe_map(svg, 575, 725, map_data, camps_data, extermination_data);
    const key_plot = create_key(key, 600, 60)

    const vis_steps = [section_1, section_2, section_3, section_4, section_5, section_6, section_7]


    const gs = d3.graphScroll()
      .container(d3.select("#container"))
      .graph(d3.select("#graph"))
      .eventId('sec1_id')
      .sections(d3.selectAll("#container #sections > section"))
      .on("active", function(i){
          console.log(i);
          vis_steps[i]();
      });

      //a function to clear the checkboxes in sections 5/6
      function clear_boxes(){
        console.log("clearing boxes")
        var checkboxes = document.getElementsByTagName('input');
        for (var i=0; i<checkboxes.length; i++)  {
          if (checkboxes[i].type == 'checkbox')   {
              checkboxes[i].checked = false;
            }
        }
      }

      //bar chart
      function section_1(){

        //make the dot plot invisible
        dot_plot.opacity(0);
        dot_plot.distance(500);
        dot_plot();

        //transition SVG to accomodate bar_chart_1
        svg.transition()
          .attr("height", 425);

        //make bar_chart_1 visible
        bar_chart_1.opacity(1)
        bar_chart_1();

        //make bar_chart_2 invisible
        bar_chart_2.opacity(0)
        bar_chart_2.color("PaleVioletRed")
        bar_chart_2();

        //make map_plot invisible
        map_plot.opacity(.00000001)
        map_plot();

        key.classed("hidden", true)

      }
      //Geographic Map
      function section_2(){

        //make the dot plot invisible if the user scrolls up
        dot_plot.opacity(0);
        dot_plot.distance(500);
        dot_plot();

        //make the bar chart invisble when user scrolls down
        bar_chart_1.opacity(0)
        bar_chart_1();

        //move the SVG to accommodate the map
        svg.transition()
          .attr("height", 650);

        //make the map visible
        map_plot.opacity(1)
        map_plot();

      }

      //dot plot -- Intro
      function section_3(){

        //bring in the dot plot
        dot_plot.opacity(1);
        dot_plot.distance(50);
        dot_plot();

        //transition the SVG to accomodate dot plot
        svg.transition()
          .attr("height", 400);

        //make bar_chart_1 invisible
        bar_chart_1.opacity(0);
        bar_chart_1();

        //bring in the new Map
        map_plot.opacity(.0000001);
        map_plot();
    }
      //dot plot -- By Demographic
      function section_4(){

        //get color option from menu
        document.getElementById('color_option').addEventListener('change', function(event){

          let color = document.getElementById("color_option").value;
          console.log(color);
          dot_plot.color(color)
        })

        //transition SVG to right size
        svg.transition()
          .attr("height", 400);

        //reset the dots
        dot_plot.add_count("reset");
        dot_plot.distance(50);
        dot_plot();

        key.classed("hidden", true);

        clear_boxes();
      }

      //dot plot -- by Camps & Ghettos
      function section_5(){

        let count = 0; //holds the number of circles to move down
          //get all selected elements from the form
          let selected = [];
          var form = document.getElementById('other_option');
          for(var i=0; i < form.length; i++){
            let current = form[i]
              form[i].onclick = function(){

                if (current.value == "reset"){
                  clear_boxes();
                }

                if (selected.includes(name)){

                  selected.filter((d)=> d == current.value)
                  dot_plot.add_count(current.value)
                }else{

                  selected.push(current.value);
                  dot_plot.add_count(current.value);
              }
            }
          }

        //transition SVG to accommodate dot plot with transitions
        svg.transition()
          .attr("height", 550);

        //transition dot plot size
        dot_plot.size(550);
        dot_plot.distance(200);
        dot_plot();

        //make sure the key stays is hidden if the user scrolls up
        key_plot.opacity(2);
        key_plot();
        key.classed("hidden", false);



      }
      //dot plot -- by Shooting and Other
      function section_6(){

        let count = 0; //holds the number of circles to move down

          //get all selected elements from the form
          let selected = [];
          var form = document.getElementById('camp_option');
          for(var i=0; i < form.length; i++){
              let current = form[i]
              form[i].onclick = function(){

                if (current.value == "reset"){
                  clear_boxes();
                }

                if (selected.includes(name)){

                  selected.filter((d)=> d == current.value)
                  dot_plot.add_count(current.value)
                }else{

                  selected.push(current.value);
                  dot_plot.add_count(current.value);
              }
            }
          }

        //make sure the dot plot is visible if user scrolls up
        dot_plot.opacity(1);
        dot_plot();

        //make sure the SVG transitions if the user scrolls up
        svg.transition()
          .attr("height", 550);

        //make sure bar_chart_2 is invisible if user scrolls up
        bar_chart_2.opacity(0)
        bar_chart_2();

        //change key to key_2
        key.classed("hidden", false);
        key_plot.opacity(1);
        key_plot();


      }
      //Conclusion + Percentage of Country Lost
      function section_7(){

        //transition svg back to barchart height
        svg.transition()
          .attr("height", 425);

        //make dot plot invisible
        dot_plot.opacity(0);
        dot_plot();

        //change bar chart text and make visible
        bar_chart_2.text("Percentage of the Jewish Population lost in the Holocaust");
        bar_chart_2.opacity(1);
        bar_chart_2();

        //hide the key
        key.classed("hidden", true);
      }

});

</script>

</body>
</html>
